{"version":3,"file":"user.js","names":["_bcryptjs","_interopRequireDefault","require","_sequelize","obj","__esModule","default","module","exports","sequelize","DataTypes","User","Model","associate","models","hasOne","Wallets","as","foreignKey","onDelete","hasMany","Transactions","init","full_name","STRING","username","email","phone_number","password","account_status","ENUM","country","referred_by","reg_date","DATE","avatar","modelName","tableName","freezeTableName","beforeCreate","user","bCrypt","hashSync","Date","getTime","split","Math","floor","random","beforeUpdate","afterCreate","dataValues"],"sources":["../../../src/database/models/user.js"],"sourcesContent":["\"use strict\";\n\nimport bCrypt from \"bcryptjs\";\nimport { Model } from \"sequelize\";\n\nmodule.exports = (sequelize, DataTypes) => {\n  class User extends Model {\n    /**\n     * Helper method for defining associations.\n     * This method is not a part of Sequelize lifecycle.\n     * The `models/index` file will call this method automatically.\n     */\n    static associate(models) {\n      // define association here\n      User.hasOne(models.Wallets, {\n        as: \"wallet\",\n        foreignKey: \"user_id\",\n        onDelete: \"CASCADE\"\n      });\n      /*User.hasOne(models.ReferralWallets, {\n        as: \"referralWallet\",\n        foreignKey: \"user_id\",\n        onDelete: \"CASCADE\"\n      });*/\n\n      User.hasMany(models.Transactions, {\n        as: \"transactions\",\n        foreignKey: \"user_id\",\n        onDelete: \"CASCADE\"\n      })\n    }\n  }\n  User.init({\n    full_name: DataTypes.STRING,\n    username: DataTypes.STRING,\n    email: DataTypes.STRING,\n    phone_number: DataTypes.STRING,\n    password: DataTypes.STRING,\n    account_status: DataTypes.ENUM(\"active\", \"pending\"),\n    country: DataTypes.STRING,\n    referred_by: DataTypes.STRING,\n    reg_date: DataTypes.DATE,\n    avatar: DataTypes.STRING\n  }, {\n    sequelize,\n    modelName: \"Users\",\n    tableName: \"Users\",\n    freezeTableName: true\n  });\n\n  //  Before the Records will be created, let's do the following.\n  User.beforeCreate((user) => {\n    user.password = bCrypt.hashSync(user.password, 10);\n    user.reg_date = new Date().getTime();\n    user.username = user.email.split(\"@\")[0] + Math.floor(Math.random() * 900);\n  });\n  User.beforeUpdate((user) => {\n    user.password = bCrypt.hashSync(user.password, 10);\n  });\n\n  //  After the record is persisted and before the persisted data are returned, let's remove the \"password\".\n  User.afterCreate((user) => {\n    delete user.dataValues.password\n  });\n\n  return User;\n};"],"mappings":"AAAA,YAAY;;AAEZ,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,UAAA,GAAAD,OAAA;AAAkC,SAAAD,uBAAAG,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;AAElCG,MAAM,CAACC,OAAO,GAAG,CAACC,SAAS,EAAEC,SAAS,KAAK;EACzC,MAAMC,IAAI,SAASC,gBAAK,CAAC;IACvB;AACJ;AACA;AACA;AACA;IACI,OAAOC,SAASA,CAACC,MAAM,EAAE;MACvB;MACAH,IAAI,CAACI,MAAM,CAACD,MAAM,CAACE,OAAO,EAAE;QAC1BC,EAAE,EAAE,QAAQ;QACZC,UAAU,EAAE,SAAS;QACrBC,QAAQ,EAAE;MACZ,CAAC,CAAC;MACF;AACN;AACA;AACA;AACA;;MAEMR,IAAI,CAACS,OAAO,CAACN,MAAM,CAACO,YAAY,EAAE;QAChCJ,EAAE,EAAE,cAAc;QAClBC,UAAU,EAAE,SAAS;QACrBC,QAAQ,EAAE;MACZ,CAAC,CAAC;IACJ;EACF;EACAR,IAAI,CAACW,IAAI,CAAC;IACRC,SAAS,EAAEb,SAAS,CAACc,MAAM;IAC3BC,QAAQ,EAAEf,SAAS,CAACc,MAAM;IAC1BE,KAAK,EAAEhB,SAAS,CAACc,MAAM;IACvBG,YAAY,EAAEjB,SAAS,CAACc,MAAM;IAC9BI,QAAQ,EAAElB,SAAS,CAACc,MAAM;IAC1BK,cAAc,EAAEnB,SAAS,CAACoB,IAAI,CAAC,QAAQ,EAAE,SAAS,CAAC;IACnDC,OAAO,EAAErB,SAAS,CAACc,MAAM;IACzBQ,WAAW,EAAEtB,SAAS,CAACc,MAAM;IAC7BS,QAAQ,EAAEvB,SAAS,CAACwB,IAAI;IACxBC,MAAM,EAAEzB,SAAS,CAACc;EACpB,CAAC,EAAE;IACDf,SAAS;IACT2B,SAAS,EAAE,OAAO;IAClBC,SAAS,EAAE,OAAO;IAClBC,eAAe,EAAE;EACnB,CAAC,CAAC;;EAEF;EACA3B,IAAI,CAAC4B,YAAY,CAAEC,IAAI,IAAK;IAC1BA,IAAI,CAACZ,QAAQ,GAAGa,iBAAM,CAACC,QAAQ,CAACF,IAAI,CAACZ,QAAQ,EAAE,EAAE,CAAC;IAClDY,IAAI,CAACP,QAAQ,GAAG,IAAIU,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC;IACpCJ,IAAI,CAACf,QAAQ,GAAGe,IAAI,CAACd,KAAK,CAACmB,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAGC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,CAAC,CAAC,GAAG,GAAG,CAAC;EAC5E,CAAC,CAAC;EACFrC,IAAI,CAACsC,YAAY,CAAET,IAAI,IAAK;IAC1BA,IAAI,CAACZ,QAAQ,GAAGa,iBAAM,CAACC,QAAQ,CAACF,IAAI,CAACZ,QAAQ,EAAE,EAAE,CAAC;EACpD,CAAC,CAAC;;EAEF;EACAjB,IAAI,CAACuC,WAAW,CAAEV,IAAI,IAAK;IACzB,OAAOA,IAAI,CAACW,UAAU,CAACvB,QAAQ;EACjC,CAAC,CAAC;EAEF,OAAOjB,IAAI;AACb,CAAC","ignoreList":[]}