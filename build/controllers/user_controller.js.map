{"version":3,"file":"user_controller.js","names":["Object","defineProperty","exports","value","default","_jsonwebtoken","_interopRequireDefault","require","_bcryptjs","_sequelize","_models","_response","_auth_validator","obj","__esModule","_defineProperty","key","_toPropertyKey","enumerable","configurable","writable","t","i","_toPrimitive","r","e","Symbol","toPrimitive","call","TypeError","String","Number","Users","Wallets","ReferralWallets","Transactions","models","UserController","req","res","requestBody","body","error","AuthValidator","signUpUserSchema","validate","response","Response","message","status","code","json","user","created","findOrCreate","where","email","defaults","id","create","amount","currency_symbol","user_id","prevAmount","findOne","referred_by","update","returnedUser","attributes","exclude","include","model","as","dataValues","console","log","loginUserSchema","name","phone","account_status","isPasswordMatched","bCrypt","compareSync","password","token","jwt","sign","process","env","JWT_SECRET_KEY","userDataValues","users","findAll","length","params","findByPk","type","duration","query","whereClause","toLowerCase","trnx_type","Op","or","eq","now","Date","createdAt","gte","setDate","getDate","setMonth","getMonth","topTraders","Sequelize","fn","col","order","group","limit","updateUserSchema","updatedUser","role","_default"],"sources":["../../src/controllers/user_controller.js"],"sourcesContent":["\"use strict\";\n\nimport jwt from \"jsonwebtoken\";\nimport bCrypt from \"bcryptjs\";\nimport { Op, Sequelize } from \"sequelize\";\nimport models from \"../database/models\";\nimport Response from \"../utils/response\";\nimport AuthValidator from \"../utils/validators/auth_validator\";\n\nconst { Users, Wallets, ReferralWallets, Transactions } = models;\n\n/**\n * @class UserController\n **/\nclass UserController {\n\n    /**\n     *@function signUpUser, (To create a user account).\n     **/\n    static signUpUser = async (req, res) => {\n        try {\n            const requestBody = req.body;\n            // console.log(\"REQUEST BODY::: \", requestBody);\n\n            //  Validate the Request Body.\n            const { error, value } = AuthValidator.signUpUserSchema.validate(requestBody);\n            if (error) {\n                const response = new Response(\n                    false,\n                    400,\n                    `${error.message}`\n                );\n                return res.status(response.code).json(response);\n            }\n\n            // Generate a Six digits OTP.\n            /*const otp = otpGenerator.generate(6, {\n                digits: true,\n                lowerCaseAlphabets: false,\n                upperCaseAlphabets: false,\n                specialChars: false\n            });\n            console.log(\"GEN OTP::: \", otp);*/\n\n            //  Send OTP to users mail.\n            // await SendOTPMail.sendMail(value.name, value.email, otp);\n            // const emailResponse = await SendOTPMail.sendMail(name, email, otp);\n            // console.log(\"EMAIL RESPONSE::: \", emailResponse.response);\n\n\n            //  Check if User already exist and create a new Users.\n            const [user, created] = await Users.findOrCreate({\n                where: { email: value.email },\n                defaults: { ...value }\n            });\n            if (!created) {\n                const response = new Response(\n                    false,\n                    409,\n                    \"User already registered. Kindly login with your credentials.\"\n                );\n                return res.status(response.code).json(response);\n            }\n            const { id } = user;\n\n\n            //  Create a Wallet and ReferralWallets.\n            await Wallets.create({\n                amount: 0.0,\n                currency_symbol: \"₦\",\n                user_id: id,\n            });\n            await ReferralWallets.create({\n                amount: 0.0,\n                currency_symbol: \"₦\",\n                user_id: id,\n            });\n\n            // Update the referrer's wallet with ₦50 bonus.\n            const { amount: prevAmount } = await ReferralWallets.findOne({\n                where: { user_id: value.referred_by },\n            });\n            await ReferralWallets.update({ amount: prevAmount + 50 }, { where: { user_id: value.referred_by } });\n\n            // TODO\n            // You can notify the referrer about the added referrer's bonus\n\n            //  Get the user back.\n            const returnedUser = await Users.findOne({\n                where: { id },\n                attributes: {\n                    exclude: [\"password\"]\n                },\n                include: {\n                    model: Wallets,\n                    as: \"wallet\",\n                    attributes: {\n                        exclude: [\"user_id\", \"createdAt\", \"updatedAt\"]\n                    }\n                }\n            });\n\n            const response = new Response(\n                true,\n                201,\n                \"Successfully registered. Kindly check your email for your validation link.\",\n                { user: returnedUser.dataValues }\n            );\n            return res.status(response.code).json(response);\n\n        } catch (error) {\n            console.log(`ERROR::: ${error}`);\n\n            const response = new Response(\n                false,\n                500,\n                'Server error, please try again later.'\n            );\n            return res.status(response.code).json(response);\n        }\n    };\n\n\n    /**\n     * @function loginUser, (To login a user).\n     **/\n    static loginUser = async (req, res) => {\n        try {\n            const requestBody = req.body;\n\n            //  Validate the Request Body.\n            const { error, value } = AuthValidator.loginUserSchema.validate(requestBody);\n            if (error) {\n                const response = new Response(\n                    false,\n                    400,\n                    `${error.message}`\n                );\n                return res.status(response.code).json(response);\n            }\n\n            //  Find the user.\n            const user = await Users.findOne({\n                where: { email: value.email },\n                include: {\n                    model: Wallets,\n                    as: \"wallet\",\n                    attributes: [\"id\", \"user_id\", \"amount\", \"currency_symbol\"]\n                }\n            });\n            if (!user) {\n                const response = new Response(\n                    false,\n                    404,\n                    \"Incorrect email. Please check your email and try again.\"\n                );\n                return res.status(response.code).json(response);\n            }\n            const { id, name, email, phone } = user;\n\n            //  Check if users account is active.\n            if (user.account_status !== \"active\") {\n                const response = new Response(\n                    true,\n                    200,\n                    \"Account is pending. Kindly check your email for your validation link or complete your account creation process.\",\n                );\n                return res.status(response.code).json(response);\n            }\n\n            //  Compare the encrypted password.\n            const isPasswordMatched = bCrypt.compareSync(value.password, user.password);\n            if (!isPasswordMatched) {\n                const response = new Response(\n                    false,\n                    401,\n                    \"Incorrect password. Please check your password and try again.\"\n                );\n                return res.status(response.code).json(response);\n            }\n\n            //  Create a Token that will be passed to the response.\n            const token = jwt.sign(\n                { id, name, email, phone },\n                `${process.env.JWT_SECRET_KEY}`,\n            );\n\n            //  Now remove the \"password\" before returning the User.\n            const userDataValues = user.dataValues;\n            delete userDataValues.password;\n\n            const response = new Response(\n                true,\n                200,\n                \"You're logged in successfully.\",\n                {\n                    user: userDataValues,\n                    token\n                }\n            );\n            return res.status(response.code).json(response);\n\n        } catch (error) {\n            console.log(`ERROR::: ${error}`);\n\n            const response = new Response(\n                false,\n                500,\n                'Server error, please try again later.'\n            );\n            return res.status(response.code).json(response);\n        }\n    };\n\n\n    /**\n     * @function getUsers, (To get all users).\n     **/\n    static getUsers = async (req, res) => {\n        try {\n            const users = await Users.findAll({\n                attributes: {\n                    exclude: [\"password\"]\n                }\n            });\n            if (!users.length) {\n                const response = new Response(\n                    false,\n                    404,\n                    \"No user found.\"\n                );\n                return res.status(response.code).json(response);\n            }\n\n            const response = new Response(\n                true,\n                200,\n                'Users retrieved successfully.',\n                { users }\n            );\n            return res.status(response.code).json(response);\n        } catch (error) {\n            console.log(`ERROR::: ${error}`);\n\n            const response = new Response(\n                false,\n                500,\n                'Server error, please try again later.'\n            );\n            return res.status(response.code).json(response);\n        }\n    };\n\n\n    /**\n     * @function getUser, (To get a single user).\n     **/\n    static getUser = async (req, res) => {\n        try {\n            const { id } = req.params;\n\n            const user = await Users.findByPk(id, {\n                attributes: {\n                    exclude: [\"password\"],\n                },\n                include: {\n                    model: Wallets,\n                    as: \"wallet\",\n                    attributes: [\"id\", \"user_id\", \"amount\", \"currency_symbol\"]\n                }\n            });\n            if (!user) {\n                const response = new Response(\n                    false,\n                    404,\n                    \"User does not exist.\"\n                );\n                return res.status(response.code).json(response);\n            }\n\n            const response = new Response(\n                true,\n                200,\n                'User retrieved successfully.',\n                { user }\n            );\n            return res.status(response.code).json(response);\n        } catch (error) {\n            console.log(`ERROR::: ${error}`);\n\n            const response = new Response(\n                false,\n                500,\n                'Server error, please try again later.'\n            );\n            return res.status(response.code).json(response);\n        }\n    };\n\n\n    /**\n     * @function getTopTraders (Get top ten users with highest transaction amount).\n     **/\n    static getTopTraders = async (req, res) => {\n        try {\n\n            const { type, duration } = req.query;\n\n            let whereClause = {};\n            if (type) {\n                if (type.toLowerCase() === \"cryptocurrency\") {\n                    whereClause.trnx_type = {\n                        [Op.or]: [\n                            { [Op.eq]: \"Coin Purchase\" },\n                            { [Op.eq]: \"Coin Sale\" }\n                        ]\n                    };\n                } else if (type === \"gift_card\") {\n                    whereClause.trnx_type = \"Gift Card Sale\";\n                }\n            }\n            if (duration) {\n                const now = new Date();\n                switch (duration.toLowerCase()) {\n                    case \"day\":\n                        whereClause.createdAt = { [Op.gte]: new Date(now.setDate(now.getDate() - 1)) };\n                        break;\n                    case \"week\":\n                        whereClause.createdAt = { [Op.gte]: new Date(now.setDate(now.getDate() - 7)) };\n                        break;\n                    case \"month\":\n                        whereClause.createdAt = { [Op.gte]: new Date(now.setMonth(now.getMonth() - 1)) };\n                        break;\n                }\n            }\n\n            const topTraders = await Transactions.findAll({\n                where: whereClause,\n                attributes: [\n                    [Sequelize.fn(\"SUM\", Sequelize.col(\"trnx_amount\")), \"total_amount\"],\n                    [Sequelize.fn(\"COUNT\", Sequelize.col(\"user_id\")), \"transaction_count\"]\n                ],\n                order: [[Sequelize.fn(\"SUM\", Sequelize.col(\"trnx_amount\")), \"DESC\"]],\n                include: {\n                    model: Users,\n                    as: \"user\",\n                    attributes: [\"id\", \"full_name\", \"username\", \"country\"]\n                },\n                group: [\"user.id\"],\n                limit: 10\n            });\n            if (!topTraders.length) {\n                const response = new Response(\n                    false,\n                    404,\n                    \"No top traders found.\"\n                );\n                return res.status(response.code).json(response);\n            }\n\n            const response = new Response(\n                true,\n                200,\n                'Top traders retrieved successfully.',\n                { topTraders }\n            );\n            return res.status(response.code).json(response);\n\n        } catch (error) {\n            console.log(`ERROR::: ${error}`);\n\n            const response = new Response(\n                false,\n                500,\n                'Server error, please try again later.'\n            );\n            return res.status(response.code).json(response);\n        }\n    }\n\n\n    /**\n     * @function updateUser, (To update a user).\n     **/\n    static updateUser = async (req, res) => {\n        try {\n            const { id } = req.params;\n            const requestBody = req.body;\n\n            //  Validate the Request Body.\n            const { error, value } = AuthValidator.updateUserSchema.validate(requestBody);\n            if (error) {\n                const response = new Response(\n                    false,\n                    400,\n                    `${error.message}`\n                );\n                return res.status(response.code).json(response);\n            }\n\n            if (value.email) {\n                const user = await Users.findOne({\n                    where: { id },\n                });\n\n                //  First check if the user Email is changed, then return error message.\n                if (user.email !== value.email) {\n                    const response = new Response(\n                        true,\n                        400,\n                        \"Error. you cannot change your email.\",\n                    );\n                    return res.status(response.code).json(response);\n                }\n            }\n\n            const updatedUser = await Users.update({ ...value }, { where: { id } });\n            if (updatedUser[0] === 0) {\n                const response = new Response(\n                    false,\n                    400,\n                    \"Failed to update user.\"\n                );\n                return res.status(response.code).json(response);\n            }\n\n            //  Get the updated user back.\n            const user = await Users.findOne({\n                where: { id },\n                attributes: {\n                    exclude: [\"password\"]\n                }\n            });\n            const { name, email, phone, role } = user;\n\n            //  Create a token.\n            const token = jwt.sign(\n                { id, name, email, phone, role },\n                `${process.env.JWT_SECRET_KEY}`,\n            );\n\n            const response = new Response(\n                true,\n                200,\n                \"Account updated successfully.\",\n                { user, token }\n            );\n            return res.status(response.code).json(response);\n\n        } catch (error) {\n            console.log(`ERROR::: ${error}`);\n\n            const response = new Response(\n                false,\n                500,\n                'Server error, please try again later.'\n            );\n            return res.status(response.code).json(response);\n        }\n    };\n}\n\nexport default UserController;"],"mappings":"AAAA,YAAY;;AAACA,MAAA,CAAAC,cAAA,CAAAC,OAAA;EAAAC,KAAA;AAAA;AAAAD,OAAA,CAAAE,OAAA;AAEb,IAAAC,aAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,UAAA,GAAAF,OAAA;AACA,IAAAG,OAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,SAAA,GAAAL,sBAAA,CAAAC,OAAA;AACA,IAAAK,eAAA,GAAAN,sBAAA,CAAAC,OAAA;AAA+D,SAAAD,uBAAAO,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAT,OAAA,EAAAS,GAAA;AAAA,SAAAE,gBAAAF,GAAA,EAAAG,GAAA,EAAAb,KAAA,IAAAa,GAAA,GAAAC,cAAA,CAAAD,GAAA,OAAAA,GAAA,IAAAH,GAAA,IAAAb,MAAA,CAAAC,cAAA,CAAAY,GAAA,EAAAG,GAAA,IAAAb,KAAA,EAAAA,KAAA,EAAAe,UAAA,QAAAC,YAAA,QAAAC,QAAA,oBAAAP,GAAA,CAAAG,GAAA,IAAAb,KAAA,WAAAU,GAAA;AAAA,SAAAI,eAAAI,CAAA,QAAAC,CAAA,GAAAC,YAAA,CAAAF,CAAA,uCAAAC,CAAA,GAAAA,CAAA,GAAAA,CAAA;AAAA,SAAAC,aAAAF,CAAA,EAAAG,CAAA,2BAAAH,CAAA,KAAAA,CAAA,SAAAA,CAAA,MAAAI,CAAA,GAAAJ,CAAA,CAAAK,MAAA,CAAAC,WAAA,kBAAAF,CAAA,QAAAH,CAAA,GAAAG,CAAA,CAAAG,IAAA,CAAAP,CAAA,EAAAG,CAAA,uCAAAF,CAAA,SAAAA,CAAA,YAAAO,SAAA,yEAAAL,CAAA,GAAAM,MAAA,GAAAC,MAAA,EAAAV,CAAA;AAE/D,MAAM;EAAEW,KAAK;EAAEC,OAAO;EAAEC,eAAe;EAAEC;AAAa,CAAC,GAAGC,eAAM;;AAEhE;AACA;AACA;AACA,MAAMC,cAAc,CAAC;AAEjB;AACJ;AACA;AAFItB,eAAA,CAFEsB,cAAc,gBAKI,OAAOC,GAAG,EAAEC,GAAG,KAAK;EACpC,IAAI;IACA,MAAMC,WAAW,GAAGF,GAAG,CAACG,IAAI;IAC5B;;IAEA;IACA,MAAM;MAAEC,KAAK;MAAEvC;IAAM,CAAC,GAAGwC,uBAAa,CAACC,gBAAgB,CAACC,QAAQ,CAACL,WAAW,CAAC;IAC7E,IAAIE,KAAK,EAAE;MACP,MAAMI,QAAQ,GAAG,IAAIC,iBAAQ,CACzB,KAAK,EACL,GAAG,EACF,GAAEL,KAAK,CAACM,OAAQ,EACrB,CAAC;MACD,OAAOT,GAAG,CAACU,MAAM,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,IAAI,CAACL,QAAQ,CAAC;IACnD;;IAEA;IACA;AACZ;AACA;AACA;AACA;AACA;AACA;;IAEY;IACA;IACA;IACA;;IAGA;IACA,MAAM,CAACM,IAAI,EAAEC,OAAO,CAAC,GAAG,MAAMrB,KAAK,CAACsB,YAAY,CAAC;MAC7CC,KAAK,EAAE;QAAEC,KAAK,EAAErD,KAAK,CAACqD;MAAM,CAAC;MAC7BC,QAAQ,EAAE;QAAE,GAAGtD;MAAM;IACzB,CAAC,CAAC;IACF,IAAI,CAACkD,OAAO,EAAE;MACV,MAAMP,QAAQ,GAAG,IAAIC,iBAAQ,CACzB,KAAK,EACL,GAAG,EACH,8DACJ,CAAC;MACD,OAAOR,GAAG,CAACU,MAAM,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,IAAI,CAACL,QAAQ,CAAC;IACnD;IACA,MAAM;MAAEY;IAAG,CAAC,GAAGN,IAAI;;IAGnB;IACA,MAAMnB,OAAO,CAAC0B,MAAM,CAAC;MACjBC,MAAM,EAAE,GAAG;MACXC,eAAe,EAAE,GAAG;MACpBC,OAAO,EAAEJ;IACb,CAAC,CAAC;IACF,MAAMxB,eAAe,CAACyB,MAAM,CAAC;MACzBC,MAAM,EAAE,GAAG;MACXC,eAAe,EAAE,GAAG;MACpBC,OAAO,EAAEJ;IACb,CAAC,CAAC;;IAEF;IACA,MAAM;MAAEE,MAAM,EAAEG;IAAW,CAAC,GAAG,MAAM7B,eAAe,CAAC8B,OAAO,CAAC;MACzDT,KAAK,EAAE;QAAEO,OAAO,EAAE3D,KAAK,CAAC8D;MAAY;IACxC,CAAC,CAAC;IACF,MAAM/B,eAAe,CAACgC,MAAM,CAAC;MAAEN,MAAM,EAAEG,UAAU,GAAG;IAAG,CAAC,EAAE;MAAER,KAAK,EAAE;QAAEO,OAAO,EAAE3D,KAAK,CAAC8D;MAAY;IAAE,CAAC,CAAC;;IAEpG;IACA;;IAEA;IACA,MAAME,YAAY,GAAG,MAAMnC,KAAK,CAACgC,OAAO,CAAC;MACrCT,KAAK,EAAE;QAAEG;MAAG,CAAC;MACbU,UAAU,EAAE;QACRC,OAAO,EAAE,CAAC,UAAU;MACxB,CAAC;MACDC,OAAO,EAAE;QACLC,KAAK,EAAEtC,OAAO;QACduC,EAAE,EAAE,QAAQ;QACZJ,UAAU,EAAE;UACRC,OAAO,EAAE,CAAC,SAAS,EAAE,WAAW,EAAE,WAAW;QACjD;MACJ;IACJ,CAAC,CAAC;IAEF,MAAMvB,QAAQ,GAAG,IAAIC,iBAAQ,CACzB,IAAI,EACJ,GAAG,EACH,4EAA4E,EAC5E;MAAEK,IAAI,EAAEe,YAAY,CAACM;IAAW,CACpC,CAAC;IACD,OAAOlC,GAAG,CAACU,MAAM,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,IAAI,CAACL,QAAQ,CAAC;EAEnD,CAAC,CAAC,OAAOJ,KAAK,EAAE;IACZgC,OAAO,CAACC,GAAG,CAAE,YAAWjC,KAAM,EAAC,CAAC;IAEhC,MAAMI,QAAQ,GAAG,IAAIC,iBAAQ,CACzB,KAAK,EACL,GAAG,EACH,uCACJ,CAAC;IACD,OAAOR,GAAG,CAACU,MAAM,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,IAAI,CAACL,QAAQ,CAAC;EACnD;AACJ,CAAC;AAGD;AACJ;AACA;AAFI/B,eAAA,CA7GEsB,cAAc,eAgHG,OAAOC,GAAG,EAAEC,GAAG,KAAK;EACnC,IAAI;IACA,MAAMC,WAAW,GAAGF,GAAG,CAACG,IAAI;;IAE5B;IACA,MAAM;MAAEC,KAAK;MAAEvC;IAAM,CAAC,GAAGwC,uBAAa,CAACiC,eAAe,CAAC/B,QAAQ,CAACL,WAAW,CAAC;IAC5E,IAAIE,KAAK,EAAE;MACP,MAAMI,QAAQ,GAAG,IAAIC,iBAAQ,CACzB,KAAK,EACL,GAAG,EACF,GAAEL,KAAK,CAACM,OAAQ,EACrB,CAAC;MACD,OAAOT,GAAG,CAACU,MAAM,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,IAAI,CAACL,QAAQ,CAAC;IACnD;;IAEA;IACA,MAAMM,IAAI,GAAG,MAAMpB,KAAK,CAACgC,OAAO,CAAC;MAC7BT,KAAK,EAAE;QAAEC,KAAK,EAAErD,KAAK,CAACqD;MAAM,CAAC;MAC7Bc,OAAO,EAAE;QACLC,KAAK,EAAEtC,OAAO;QACduC,EAAE,EAAE,QAAQ;QACZJ,UAAU,EAAE,CAAC,IAAI,EAAE,SAAS,EAAE,QAAQ,EAAE,iBAAiB;MAC7D;IACJ,CAAC,CAAC;IACF,IAAI,CAAChB,IAAI,EAAE;MACP,MAAMN,QAAQ,GAAG,IAAIC,iBAAQ,CACzB,KAAK,EACL,GAAG,EACH,yDACJ,CAAC;MACD,OAAOR,GAAG,CAACU,MAAM,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,IAAI,CAACL,QAAQ,CAAC;IACnD;IACA,MAAM;MAAEY,EAAE;MAAEmB,IAAI;MAAErB,KAAK;MAAEsB;IAAM,CAAC,GAAG1B,IAAI;;IAEvC;IACA,IAAIA,IAAI,CAAC2B,cAAc,KAAK,QAAQ,EAAE;MAClC,MAAMjC,QAAQ,GAAG,IAAIC,iBAAQ,CACzB,IAAI,EACJ,GAAG,EACH,iHACJ,CAAC;MACD,OAAOR,GAAG,CAACU,MAAM,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,IAAI,CAACL,QAAQ,CAAC;IACnD;;IAEA;IACA,MAAMkC,iBAAiB,GAAGC,iBAAM,CAACC,WAAW,CAAC/E,KAAK,CAACgF,QAAQ,EAAE/B,IAAI,CAAC+B,QAAQ,CAAC;IAC3E,IAAI,CAACH,iBAAiB,EAAE;MACpB,MAAMlC,QAAQ,GAAG,IAAIC,iBAAQ,CACzB,KAAK,EACL,GAAG,EACH,+DACJ,CAAC;MACD,OAAOR,GAAG,CAACU,MAAM,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,IAAI,CAACL,QAAQ,CAAC;IACnD;;IAEA;IACA,MAAMsC,KAAK,GAAGC,qBAAG,CAACC,IAAI,CAClB;MAAE5B,EAAE;MAAEmB,IAAI;MAAErB,KAAK;MAAEsB;IAAM,CAAC,EACzB,GAAES,OAAO,CAACC,GAAG,CAACC,cAAe,EAClC,CAAC;;IAED;IACA,MAAMC,cAAc,GAAGtC,IAAI,CAACqB,UAAU;IACtC,OAAOiB,cAAc,CAACP,QAAQ;IAE9B,MAAMrC,QAAQ,GAAG,IAAIC,iBAAQ,CACzB,IAAI,EACJ,GAAG,EACH,gCAAgC,EAChC;MACIK,IAAI,EAAEsC,cAAc;MACpBN;IACJ,CACJ,CAAC;IACD,OAAO7C,GAAG,CAACU,MAAM,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,IAAI,CAACL,QAAQ,CAAC;EAEnD,CAAC,CAAC,OAAOJ,KAAK,EAAE;IACZgC,OAAO,CAACC,GAAG,CAAE,YAAWjC,KAAM,EAAC,CAAC;IAEhC,MAAMI,QAAQ,GAAG,IAAIC,iBAAQ,CACzB,KAAK,EACL,GAAG,EACH,uCACJ,CAAC;IACD,OAAOR,GAAG,CAACU,MAAM,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,IAAI,CAACL,QAAQ,CAAC;EACnD;AACJ,CAAC;AAGD;AACJ;AACA;AAFI/B,eAAA,CAzMEsB,cAAc,cA4ME,OAAOC,GAAG,EAAEC,GAAG,KAAK;EAClC,IAAI;IACA,MAAMoD,KAAK,GAAG,MAAM3D,KAAK,CAAC4D,OAAO,CAAC;MAC9BxB,UAAU,EAAE;QACRC,OAAO,EAAE,CAAC,UAAU;MACxB;IACJ,CAAC,CAAC;IACF,IAAI,CAACsB,KAAK,CAACE,MAAM,EAAE;MACf,MAAM/C,QAAQ,GAAG,IAAIC,iBAAQ,CACzB,KAAK,EACL,GAAG,EACH,gBACJ,CAAC;MACD,OAAOR,GAAG,CAACU,MAAM,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,IAAI,CAACL,QAAQ,CAAC;IACnD;IAEA,MAAMA,QAAQ,GAAG,IAAIC,iBAAQ,CACzB,IAAI,EACJ,GAAG,EACH,+BAA+B,EAC/B;MAAE4C;IAAM,CACZ,CAAC;IACD,OAAOpD,GAAG,CAACU,MAAM,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,IAAI,CAACL,QAAQ,CAAC;EACnD,CAAC,CAAC,OAAOJ,KAAK,EAAE;IACZgC,OAAO,CAACC,GAAG,CAAE,YAAWjC,KAAM,EAAC,CAAC;IAEhC,MAAMI,QAAQ,GAAG,IAAIC,iBAAQ,CACzB,KAAK,EACL,GAAG,EACH,uCACJ,CAAC;IACD,OAAOR,GAAG,CAACU,MAAM,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,IAAI,CAACL,QAAQ,CAAC;EACnD;AACJ,CAAC;AAGD;AACJ;AACA;AAFI/B,eAAA,CAhPEsB,cAAc,aAmPC,OAAOC,GAAG,EAAEC,GAAG,KAAK;EACjC,IAAI;IACA,MAAM;MAAEmB;IAAG,CAAC,GAAGpB,GAAG,CAACwD,MAAM;IAEzB,MAAM1C,IAAI,GAAG,MAAMpB,KAAK,CAAC+D,QAAQ,CAACrC,EAAE,EAAE;MAClCU,UAAU,EAAE;QACRC,OAAO,EAAE,CAAC,UAAU;MACxB,CAAC;MACDC,OAAO,EAAE;QACLC,KAAK,EAAEtC,OAAO;QACduC,EAAE,EAAE,QAAQ;QACZJ,UAAU,EAAE,CAAC,IAAI,EAAE,SAAS,EAAE,QAAQ,EAAE,iBAAiB;MAC7D;IACJ,CAAC,CAAC;IACF,IAAI,CAAChB,IAAI,EAAE;MACP,MAAMN,QAAQ,GAAG,IAAIC,iBAAQ,CACzB,KAAK,EACL,GAAG,EACH,sBACJ,CAAC;MACD,OAAOR,GAAG,CAACU,MAAM,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,IAAI,CAACL,QAAQ,CAAC;IACnD;IAEA,MAAMA,QAAQ,GAAG,IAAIC,iBAAQ,CACzB,IAAI,EACJ,GAAG,EACH,8BAA8B,EAC9B;MAAEK;IAAK,CACX,CAAC;IACD,OAAOb,GAAG,CAACU,MAAM,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,IAAI,CAACL,QAAQ,CAAC;EACnD,CAAC,CAAC,OAAOJ,KAAK,EAAE;IACZgC,OAAO,CAACC,GAAG,CAAE,YAAWjC,KAAM,EAAC,CAAC;IAEhC,MAAMI,QAAQ,GAAG,IAAIC,iBAAQ,CACzB,KAAK,EACL,GAAG,EACH,uCACJ,CAAC;IACD,OAAOR,GAAG,CAACU,MAAM,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,IAAI,CAACL,QAAQ,CAAC;EACnD;AACJ,CAAC;AAGD;AACJ;AACA;AAFI/B,eAAA,CA9REsB,cAAc,mBAiSO,OAAOC,GAAG,EAAEC,GAAG,KAAK;EACvC,IAAI;IAEA,MAAM;MAAEyD,IAAI;MAAEC;IAAS,CAAC,GAAG3D,GAAG,CAAC4D,KAAK;IAEpC,IAAIC,WAAW,GAAG,CAAC,CAAC;IACpB,IAAIH,IAAI,EAAE;MACN,IAAIA,IAAI,CAACI,WAAW,CAAC,CAAC,KAAK,gBAAgB,EAAE;QACzCD,WAAW,CAACE,SAAS,GAAG;UACpB,CAACC,aAAE,CAACC,EAAE,GAAG,CACL;YAAE,CAACD,aAAE,CAACE,EAAE,GAAG;UAAgB,CAAC,EAC5B;YAAE,CAACF,aAAE,CAACE,EAAE,GAAG;UAAY,CAAC;QAEhC,CAAC;MACL,CAAC,MAAM,IAAIR,IAAI,KAAK,WAAW,EAAE;QAC7BG,WAAW,CAACE,SAAS,GAAG,gBAAgB;MAC5C;IACJ;IACA,IAAIJ,QAAQ,EAAE;MACV,MAAMQ,GAAG,GAAG,IAAIC,IAAI,CAAC,CAAC;MACtB,QAAQT,QAAQ,CAACG,WAAW,CAAC,CAAC;QAC1B,KAAK,KAAK;UACND,WAAW,CAACQ,SAAS,GAAG;YAAE,CAACL,aAAE,CAACM,GAAG,GAAG,IAAIF,IAAI,CAACD,GAAG,CAACI,OAAO,CAACJ,GAAG,CAACK,OAAO,CAAC,CAAC,GAAG,CAAC,CAAC;UAAE,CAAC;UAC9E;QACJ,KAAK,MAAM;UACPX,WAAW,CAACQ,SAAS,GAAG;YAAE,CAACL,aAAE,CAACM,GAAG,GAAG,IAAIF,IAAI,CAACD,GAAG,CAACI,OAAO,CAACJ,GAAG,CAACK,OAAO,CAAC,CAAC,GAAG,CAAC,CAAC;UAAE,CAAC;UAC9E;QACJ,KAAK,OAAO;UACRX,WAAW,CAACQ,SAAS,GAAG;YAAE,CAACL,aAAE,CAACM,GAAG,GAAG,IAAIF,IAAI,CAACD,GAAG,CAACM,QAAQ,CAACN,GAAG,CAACO,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC;UAAE,CAAC;UAChF;MACR;IACJ;IAEA,MAAMC,UAAU,GAAG,MAAM9E,YAAY,CAACyD,OAAO,CAAC;MAC1CrC,KAAK,EAAE4C,WAAW;MAClB/B,UAAU,EAAE,CACR,CAAC8C,oBAAS,CAACC,EAAE,CAAC,KAAK,EAAED,oBAAS,CAACE,GAAG,CAAC,aAAa,CAAC,CAAC,EAAE,cAAc,CAAC,EACnE,CAACF,oBAAS,CAACC,EAAE,CAAC,OAAO,EAAED,oBAAS,CAACE,GAAG,CAAC,SAAS,CAAC,CAAC,EAAE,mBAAmB,CAAC,CACzE;MACDC,KAAK,EAAE,CAAC,CAACH,oBAAS,CAACC,EAAE,CAAC,KAAK,EAAED,oBAAS,CAACE,GAAG,CAAC,aAAa,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC;MACpE9C,OAAO,EAAE;QACLC,KAAK,EAAEvC,KAAK;QACZwC,EAAE,EAAE,MAAM;QACVJ,UAAU,EAAE,CAAC,IAAI,EAAE,WAAW,EAAE,UAAU,EAAE,SAAS;MACzD,CAAC;MACDkD,KAAK,EAAE,CAAC,SAAS,CAAC;MAClBC,KAAK,EAAE;IACX,CAAC,CAAC;IACF,IAAI,CAACN,UAAU,CAACpB,MAAM,EAAE;MACpB,MAAM/C,QAAQ,GAAG,IAAIC,iBAAQ,CACzB,KAAK,EACL,GAAG,EACH,uBACJ,CAAC;MACD,OAAOR,GAAG,CAACU,MAAM,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,IAAI,CAACL,QAAQ,CAAC;IACnD;IAEA,MAAMA,QAAQ,GAAG,IAAIC,iBAAQ,CACzB,IAAI,EACJ,GAAG,EACH,qCAAqC,EACrC;MAAEkE;IAAW,CACjB,CAAC;IACD,OAAO1E,GAAG,CAACU,MAAM,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,IAAI,CAACL,QAAQ,CAAC;EAEnD,CAAC,CAAC,OAAOJ,KAAK,EAAE;IACZgC,OAAO,CAACC,GAAG,CAAE,YAAWjC,KAAM,EAAC,CAAC;IAEhC,MAAMI,QAAQ,GAAG,IAAIC,iBAAQ,CACzB,KAAK,EACL,GAAG,EACH,uCACJ,CAAC;IACD,OAAOR,GAAG,CAACU,MAAM,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,IAAI,CAACL,QAAQ,CAAC;EACnD;AACJ,CAAC;AAGD;AACJ;AACA;AAFI/B,eAAA,CA/WEsB,cAAc,gBAkXI,OAAOC,GAAG,EAAEC,GAAG,KAAK;EACpC,IAAI;IACA,MAAM;MAAEmB;IAAG,CAAC,GAAGpB,GAAG,CAACwD,MAAM;IACzB,MAAMtD,WAAW,GAAGF,GAAG,CAACG,IAAI;;IAE5B;IACA,MAAM;MAAEC,KAAK;MAAEvC;IAAM,CAAC,GAAGwC,uBAAa,CAAC6E,gBAAgB,CAAC3E,QAAQ,CAACL,WAAW,CAAC;IAC7E,IAAIE,KAAK,EAAE;MACP,MAAMI,QAAQ,GAAG,IAAIC,iBAAQ,CACzB,KAAK,EACL,GAAG,EACF,GAAEL,KAAK,CAACM,OAAQ,EACrB,CAAC;MACD,OAAOT,GAAG,CAACU,MAAM,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,IAAI,CAACL,QAAQ,CAAC;IACnD;IAEA,IAAI3C,KAAK,CAACqD,KAAK,EAAE;MACb,MAAMJ,IAAI,GAAG,MAAMpB,KAAK,CAACgC,OAAO,CAAC;QAC7BT,KAAK,EAAE;UAAEG;QAAG;MAChB,CAAC,CAAC;;MAEF;MACA,IAAIN,IAAI,CAACI,KAAK,KAAKrD,KAAK,CAACqD,KAAK,EAAE;QAC5B,MAAMV,QAAQ,GAAG,IAAIC,iBAAQ,CACzB,IAAI,EACJ,GAAG,EACH,sCACJ,CAAC;QACD,OAAOR,GAAG,CAACU,MAAM,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,IAAI,CAACL,QAAQ,CAAC;MACnD;IACJ;IAEA,MAAM2E,WAAW,GAAG,MAAMzF,KAAK,CAACkC,MAAM,CAAC;MAAE,GAAG/D;IAAM,CAAC,EAAE;MAAEoD,KAAK,EAAE;QAAEG;MAAG;IAAE,CAAC,CAAC;IACvE,IAAI+D,WAAW,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE;MACtB,MAAM3E,QAAQ,GAAG,IAAIC,iBAAQ,CACzB,KAAK,EACL,GAAG,EACH,wBACJ,CAAC;MACD,OAAOR,GAAG,CAACU,MAAM,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,IAAI,CAACL,QAAQ,CAAC;IACnD;;IAEA;IACA,MAAMM,IAAI,GAAG,MAAMpB,KAAK,CAACgC,OAAO,CAAC;MAC7BT,KAAK,EAAE;QAAEG;MAAG,CAAC;MACbU,UAAU,EAAE;QACRC,OAAO,EAAE,CAAC,UAAU;MACxB;IACJ,CAAC,CAAC;IACF,MAAM;MAAEQ,IAAI;MAAErB,KAAK;MAAEsB,KAAK;MAAE4C;IAAK,CAAC,GAAGtE,IAAI;;IAEzC;IACA,MAAMgC,KAAK,GAAGC,qBAAG,CAACC,IAAI,CAClB;MAAE5B,EAAE;MAAEmB,IAAI;MAAErB,KAAK;MAAEsB,KAAK;MAAE4C;IAAK,CAAC,EAC/B,GAAEnC,OAAO,CAACC,GAAG,CAACC,cAAe,EAClC,CAAC;IAED,MAAM3C,QAAQ,GAAG,IAAIC,iBAAQ,CACzB,IAAI,EACJ,GAAG,EACH,+BAA+B,EAC/B;MAAEK,IAAI;MAAEgC;IAAM,CAClB,CAAC;IACD,OAAO7C,GAAG,CAACU,MAAM,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,IAAI,CAACL,QAAQ,CAAC;EAEnD,CAAC,CAAC,OAAOJ,KAAK,EAAE;IACZgC,OAAO,CAACC,GAAG,CAAE,YAAWjC,KAAM,EAAC,CAAC;IAEhC,MAAMI,QAAQ,GAAG,IAAIC,iBAAQ,CACzB,KAAK,EACL,GAAG,EACH,uCACJ,CAAC;IACD,OAAOR,GAAG,CAACU,MAAM,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,IAAI,CAACL,QAAQ,CAAC;EACnD;AACJ,CAAC;AAAA,IAAA6E,QAAA,GAAAzH,OAAA,CAAAE,OAAA,GAGUiC,cAAc","ignoreList":[]}